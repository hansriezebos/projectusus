<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension point="org.eclipse.ui.views">
       <view class="org.projectusus.ui.dependencygraph.ClassGraphView"
            icon="icons/graph-class.gif"
            id="org.projectusus.ui.dependencygraph.ClassGraphView"
            category="org.projectusus.ui.viewCategory"
            name="Usus Class Graph"/>
       <view class="org.projectusus.ui.dependencygraph.PackageGraphView"
            icon="icons/graph-package.gif"
            id="org.projectusus.ui.dependencygraph.PackageGraphView"
            category="org.projectusus.ui.viewCategory"
            name="Usus Package Graph"/>
       <view
             class="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView"
             icon="icons/graph-cross-package.gif"
             id="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView"
             category="org.projectusus.ui.viewCategory"
             name="Cross-Package Class Graph"
             restorable="true">
       </view>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.projectusus.ui.internal.perspective.USUSPerspective">
         <view
               id="org.projectusus.ui.dependencygraph.ClassGraphView"
               minimized="false"
               relationship="top"
               relative="org.projectusus.ui.internal.hotspots.HotSpotsView">
         </view>
         <view
               id="org.projectusus.ui.dependencygraph.PackageGraphView"
               minimized="false"
               relationship="stack"
               relative="org.projectusus.ui.dependencygraph.ClassGraphView">
         </view>
         <view
               id="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView"
               minimized="false"
               relationship="stack"
               relative="org.projectusus.ui.dependencygraph.ClassGraphView">
         </view>
         <viewShortcut
               id="org.projectusus.ui.dependencygraph.ClassGraphView">
         </viewShortcut>
         <viewShortcut
               id="org.projectusus.ui.dependencygraph.PackageGraphView">
         </viewShortcut>
         <viewShortcut
               id="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView">
         </viewShortcut>
         <showInPart
               id="org.projectusus.ui.dependencygraph.ClassGraphView">
         </showInPart>
      </perspectiveExtension>
      <perspectiveExtension
            targetID="org.eclipse.jdt.ui.JavaPerspective">
         <showInPart
               id="org.projectusus.ui.dependencygraph.ClassGraphView">
         </showInPart>
      </perspectiveExtension>
      <perspectiveExtension
            targetID="org.eclipse.jdt.ui.JavaBrowsingPerspective">
         <showInPart
               id="org.projectusus.ui.dependencygraph.ClassGraphView">
         </showInPart>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="org.projectusus.ui.dependencygraph.handlers.ClearCustomFilter"
            commandId="org.projectusus.ui.dependencygraph.command.ClearCustomFilter">
         <activeWhen>
         	<and>
                <with
                  	variable="activePartId">
               		<equals
                    	value="org.projectusus.ui.dependencygraph.ClassGraphView">
               		</equals>
            	</with>
                <with
                  	variable="activeContexts">
                  	<iterate ifEmpty="false" operator="or">
	               		<equals
	                    	value="org.projectusus.ui.dependencygraph.ClassGraphView.context.customFilter">
	               		</equals>
               		</iterate>
            	</with>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="org.projectusus.ui.dependencygraph.handlers.ClearCustomFilter"
            commandId="org.projectusus.ui.dependencygraph.command.ClearCustomFilter">
         <activeWhen>
            <and>
               <with
                     variable="activePartId">
                  <equals
                        value="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView">
                  </equals>
               </with>
               <with
                     variable="activeContexts">
                  <iterate
                        ifEmpty="false"
                        operator="or">
                     <equals
                           value="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView.context.customFilter">
                     </equals>
                  </iterate>
               </with>
            </and>
         </activeWhen>
      </handler>
      <handler
            class="org.projectusus.ui.dependencygraph.handlers.ShowPackagesInClassGraph"
            commandId="org.projectusus.ui.dependencygraph.command.ShowPackagesInClassGraph">
<!--
         <activeWhen>
            <with
                  variable="selection">
               <iterate
                     ifEmpty="false"
                     operator="or">
                  <instanceof
                        value="org.projectusus.core.internal.proportions.rawdata.PackageRepresenter">
                  </instanceof>
               </iterate>
            </with>
         </activeWhen>
         -->
      </handler>
      <handler
            class="org.projectusus.ui.dependencygraph.handlers.RefreshGraphView"
            commandId="org.projectusus.ui.dependencygraph.command.RefreshGraphView">
         <activeWhen>
            <with
                  variable="activePart">
               <instanceof
                     value="org.projectusus.ui.dependencygraph.common.DependencyGraphView">
               </instanceof>
            </with>
         </activeWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            description="Clears the currently set custom filter."
            id="org.projectusus.ui.dependencygraph.command.ClearCustomFilter"
            name="Clear custom filter">
      </command>
      <command
            id="org.projectusus.ui.dependencygraph.command.ShowPackagesInClassGraph"
            name="Show in class graph">
         <commandParameter
               id="org.projectusus.ui.dependencygraph.handlers.ShowPackagesInClassGraph.targetViewId"
               name="targetViewId"
               optional="true">
         </commandParameter>
      </command>
      <command
            description="Redraws the package dependency graph."
            id="org.projectusus.ui.dependencygraph.command.RefreshGraphView"
            name="Refresh">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="toolbar:org.projectusus.ui.dependencygraph.ClassGraphView">
         <command
               commandId="org.projectusus.ui.dependencygraph.command.ClearCustomFilter"
               style="push">
         </command>
         <command
               commandId="org.projectusus.ui.dependencygraph.command.RefreshGraphView"
               style="push">
         </command>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="toolbar:org.projectusus.ui.dependencygraph.CrossPackageClassGraphView">
         <command
               commandId="org.projectusus.ui.dependencygraph.command.ClearCustomFilter"
               style="push">
         </command>
         <command
               commandId="org.projectusus.ui.dependencygraph.command.RefreshGraphView"
               style="push">
         </command>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="toolbar:org.projectusus.ui.dependencygraph.PackageGraphView">
         <command
               commandId="org.projectusus.ui.dependencygraph.command.ShowPackagesInClassGraph"
               icon="icons/graph-class.gif"
               label="Show in class graph"
               style="push">
            <parameter
                  name="org.projectusus.ui.dependencygraph.handlers.ShowPackagesInClassGraph.targetViewId"
                  value="org.projectusus.ui.dependencygraph.ClassGraphView">
            </parameter>
         </command>
         <command
               commandId="org.projectusus.ui.dependencygraph.command.ShowPackagesInClassGraph"
               icon="icons/graph-cross-package.gif"
               label="Show in cross-package class graph"
               style="push">
            <parameter
                  name="org.projectusus.ui.dependencygraph.handlers.ShowPackagesInClassGraph.targetViewId"
                  value="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView">
            </parameter>
         </command>
         <command
               commandId="org.projectusus.ui.dependencygraph.command.RefreshGraphView"
               style="push">
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.commandImages">
      <image
            commandId="org.projectusus.ui.dependencygraph.command.ClearCustomFilter"
            icon="icons/clear-filters.gif">
      </image>
      <image
            commandId="org.projectusus.ui.dependencygraph.command.RefreshGraphView"
            icon="icons/refresh.gif">
      </image>
   </extension>
   <extension
         point="org.eclipse.ui.contexts">
      <context
            id="org.projectusus.ui.dependencygraph.ClassGraphView.context.customFilter"
            name="org.projectusus.ui.dependencygraph.ClassGraphView.context.customFilter">
      </context>
      <context
            id="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView.context.customFilter"
            name="org.projectusus.ui.dependencygraph.CrossPackageClassGraphView.context.customFilter">
      </context>
      <context
            id="org.projectusus.ui.dependencygraph.PackageGraphView.context.customFilter"
            name="org.projectusus.ui.dependencygraph.PackageGraphView.context.customFilter">
      </context>
   </extension>
   

</plugin>
